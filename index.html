<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Free CV Builder - ATS Optimized</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/docx@8.5.0/build/index.min.js"></script>
<style>
* {margin:0;padding:0;box-sizing:border-box;}
body {font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:#f0f2f5;color:#333;}

/* Mobile Menu Toggle */
.mobile-menu-toggle {
    display: none;
    position: fixed;
    top: 15px;
    left: 15px;
    z-index: 1001;
    background: #1e293b;
    color: white;
    border: none;
    padding: 12px 15px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1.2em;
    box-shadow: 0 2px 10px rgba(0,0,0,0.3);
}

.mobile-menu-toggle:active {
    transform: scale(0.95);
}

/* Overlay for mobile menu */
.sidebar-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    z-index: 999;
}

.sidebar-overlay.active {
    display: block;
}

/* Main Layout */
.app-container {display:flex;min-height:100vh;}
.sidebar {
    width:280px;
    background:#1e293b;
    color:white;
    padding:20px;
    overflow-y:auto;
    position:fixed;
    height:100vh;
    transition: transform 0.3s ease;
    z-index: 1000;
}

.main-content {flex:1;margin-left:280px;display:flex;}
.form-section {flex:1;padding:30px;background:#fff;overflow-y:auto;border-right:2px solid #e0e0e0;}
.preview-section {flex:1;padding:30px;overflow-y:auto;background:#f5f5f5;}

/* Sidebar Styles */
.logo {font-size:1.5em;font-weight:700;margin-bottom:30px;text-align:center;border-bottom:2px solid #3b82f6;padding-bottom:15px;padding-top:0;}
.nav-item {padding:12px 15px;margin:8px 0;border-radius:8px;cursor:pointer;transition:all 0.3s;display:flex;align-items:center;gap:10px;}
.nav-item:hover, .nav-item.active {background:#3b82f6;}
.nav-item i {width:20px;}
.score-card {background:#334155;padding:15px;border-radius:8px;margin-top:20px;}
.score-value {font-size:2.5em;font-weight:700;color:#10b981;text-align:center;}
.score-label {text-align:center;font-size:0.9em;opacity:0.8;margin-top:5px;}
.keyword-badge {background:#3b82f6;padding:4px 8px;border-radius:4px;font-size:0.75em;display:inline-block;margin:3px;}

/* Form Styles */
.form-header {margin-bottom:30px;}
.form-header h1 {color:#0f172a;font-size:2em;margin-bottom:10px;}
.form-header p {color:#666;}

.tab-container {
    display:flex;
    gap:10px;
    margin-bottom:20px;
    border-bottom:2px solid #e0e0e0;
    overflow-x:auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
}

.tab-container::-webkit-scrollbar {
    display: none;
}

.tab {
    padding:12px 20px;
    cursor:pointer;
    border:none;
    background:none;
    font-size:1em;
    color:#666;
    transition:all 0.3s;
    white-space:nowrap;
    min-width: fit-content;
    -webkit-tap-highlight-color: transparent;
}

.tab.active {color:#0f172a;border-bottom:3px solid #0f172a;font-weight:600;}
.tab:hover {color:#0f172a;}

.tab-content {display:none;}
.tab-content.active {display:block;}

.form-group {margin-bottom:20px;}
.form-group label {display:block;margin-bottom:8px;font-weight:600;color:#333;}
.form-group input, .form-group textarea, .form-group select {
    width:100%;
    padding:12px;
    border:1px solid #ddd;
    border-radius:5px;
    font-size:1em;
    font-family:inherit;
    -webkit-appearance: none;
}
.form-group textarea {min-height:100px;resize:vertical;}
.form-group input:focus, .form-group textarea:focus, .form-group select:focus {outline:none;border-color:#0f172a;}
.form-group small {color:#666;font-size:0.85em;display:block;margin-top:4px;}

.section-header {background:#0f172a;color:white;padding:15px;margin:30px -30px 20px -30px;font-size:1.3em;}

/* Dynamic Items */
.dynamic-item {background:#f8f9fa;padding:15px;border-radius:5px;margin-bottom:15px;border-left:4px solid #0f172a;position:relative;padding-right: 80px;}
.dynamic-item .remove-btn {position:absolute;top:10px;right:10px;background:#dc2626;color:white;border:none;padding:8px 12px;border-radius:3px;cursor:pointer;font-size:0.85em;touch-action: manipulation;}
.dynamic-item .remove-btn:hover {background:#b91c1c;}

.add-btn {
    background:#0f172a;
    color:white;
    border:none;
    padding:12px 20px;
    border-radius:5px;
    cursor:pointer;
    font-size:1em;
    margin-top:10px;
    touch-action: manipulation;
}
.add-btn:hover {background:#1e293b;}

.skill-input-container {display:flex;gap:10px;margin-bottom:10px;flex-wrap: wrap;}
.skill-input-container input {flex:1;min-width: 200px;}
.skill-input-container button {background:#dc2626;color:white;border:none;padding:10px 15px;border-radius:5px;cursor:pointer;touch-action: manipulation;}

/* Action Buttons */
.action-buttons {
    position:sticky;
    top:0;
    background:white;
    padding:15px 0;
    margin-bottom:20px;
    border-bottom:2px solid #e0e0e0;
    display:flex;
    gap:10px;
    z-index:10;
    flex-wrap:wrap;
}

.action-buttons button {
    flex:1;
    min-width:120px;
    padding:12px 20px;
    border:none;
    border-radius:5px;
    cursor:pointer;
    font-size:1em;
    font-weight:600;
    transition:all 0.3s;
    touch-action: manipulation;
}

.generate-btn {background:#10b981;color:white;}
.generate-btn:hover {background:#059669;}
.download-btn {background:#3b82f6;color:white;}
.download-btn:hover {background:#2563eb;}
.save-btn {background:#8b5cf6;color:white;}
.save-btn:hover {background:#7c3aed;}
.load-btn {background:#f59e0b;color:white;}
.load-btn:hover {background:#d97706;}

/* ATS Analyzer */
.ats-analyzer {background:#f8f9fa;padding:20px;border-radius:8px;border-left:4px solid #3b82f6;margin-bottom:20px;}
.ats-results {margin-top:15px;}
.keyword-list {display:flex;flex-wrap:wrap;gap:8px;margin-top:10px;}
.keyword-item {background:#3b82f6;color:white;padding:6px 12px;border-radius:20px;font-size:0.9em;cursor:pointer;transition:all 0.3s;touch-action: manipulation;}
.keyword-item:hover {background:#2563eb;transform:scale(1.05);}
.keyword-item.matched {background:#10b981;}
.keyword-item.missing {background:#dc2626;}

.match-score {display:flex;gap:20px;margin-top:15px;flex-wrap: wrap;}
.score-box {flex:1;min-width: 120px;background:white;padding:15px;border-radius:8px;text-align:center;box-shadow:0 2px 4px rgba(0,0,0,0.1);}
.score-box .value {font-size:2em;font-weight:700;color:#3b82f6;}
.score-box .label {font-size:0.9em;color:#666;margin-top:5px;}

/* Feedback Panel */
.feedback-panel {background:#fef3c7;border-left:4px solid:#f59e0b;padding:15px;border-radius:5px;margin-bottom:15px;}
.feedback-item {margin:8px 0;display:flex;align-items:start;gap:8px;}
.feedback-item i {color:#f59e0b;margin-top:3px;}

/* CV Preview Styles */
.cv-preview {background:white;box-shadow:0 0 20px rgba(0,0,0,0.1);display:none;}
.cv-preview.active {display:block;}

.container {max-width:900px;margin:0 auto;background-color:white;box-shadow:0 0 20px rgba(0,0,0,0.1);font-family:'Bahnschrift Light','Bahnschrift',sans-serif;font-weight:300;line-height:1.6;}
header {background:linear-gradient(135deg,#0f172a 0%,#1e293b 100%);color:white;padding:35px 40px;text-align:center;}
header h1 {font-size:2em;margin-bottom:8px;font-weight:700;}
header p {font-size:1em;margin-bottom:12px;}
.contact-info {margin-top:12px;}
.contact-info a {color:white;text-decoration:none;margin:0 10px;font-size:1em;opacity:0.9;transition:opacity 0.3s;}
.contact-info a:hover {opacity:1;text-decoration:underline;}
.contact-info i {margin-right:5px;}
.content {padding:40px;}
section {margin-bottom:40px;}
h2 {color:#0f172a;font-size:1.8em;margin-bottom:20px;padding-bottom:10px;border-bottom:3px solid #0f172a;}
h3 {color:#333;font-size:1.3em;margin-bottom:5px;}
.job-title {display:flex;justify-content:space-between;align-items:baseline;margin-bottom:5px;flex-wrap:wrap;}
.job-title h3 {margin:0;}
.date {color:#666;font-style:italic;font-size:0.95em;}
.company {color:#555;font-size:1.05em;margin-bottom:15px;}
.experience-item, .education-item {margin-bottom:30px;}
.cv-preview ul {margin-left:20px;margin-top:10px;}
.cv-preview li {margin-bottom:8px;}
.skills {display:flex;flex-wrap:wrap;gap:15px;}
.skill-tag {background-color:#0f172a;color:white;padding:8px 16px;border-radius:20px;font-size:0.95em;}
.summary {font-size:1.05em;line-height:1.8;color:#555;background-color:#f8f9fa;padding:20px;border-radius:8px;border-left:4px solid #0f172a;}
.languages span {display:inline-block;margin-right:20px;margin-bottom:10px;}
.publication {margin-bottom:15px;padding:15px;background-color:#f8f9fa;border-radius:5px;}
.publication a {color:#0f172a;text-decoration:none;}
.publication a:hover {text-decoration:underline;}
.collapsible {background-color:#f1f1f1;color:#333;cursor:pointer;padding:12px 18px;width:100%;border:none;text-align:left;outline:none;font-size:1.1em;border-left:4px solid #0f172a;margin-bottom:5px;transition:background-color 0.3s;position:relative;padding-left:45px;}
.collapsible::before {content:"+";position:absolute;left:18px;font-size:1.4em;font-weight:900;color:#dc2626;transition:transform 0.3s;}
.active-collapsible::before {content:"−";}
.active-collapsible, .collapsible:hover {background-color:#e2e2e2;}
.content-collapsible {padding:0 18px;display:none;overflow:hidden;background-color:#fafafa;border-left:4px solid #0f172a;margin-bottom:15px;}
.content-collapsible p, .content-collapsible ul {padding:15px 0;}

/* Modal */
.modal {display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.5);}
.modal-content {background:white;margin:50px auto;padding:30px;border-radius:8px;max-width:500px;position:relative;}
.close-modal {position:absolute;right:15px;top:15px;font-size:1.5em;cursor:pointer;color:#666;}
.close-modal:hover {color:#333;}
.saved-cv-item {background:#f8f9fa;padding:15px;margin:10px 0;border-radius:5px;display:flex;justify-content:space-between;align-items:center;cursor:pointer;}
.saved-cv-item:hover {background:#e5e7eb;}

@media (max-width:1400px) {
    .sidebar {width:240px;}
    .main-content {margin-left:240px;}
}

@media (max-width:1200px) {
    .mobile-menu-toggle {
        display: block;
    }
    
    .sidebar {
        transform: translateX(-100%);
        padding-top: 70px;
    }
    
    .sidebar.active {
        transform: translateX(0);
    }
    
    .main-content {
        margin-left:0;
        flex-direction:column;
    }
    
    .form-section {
        border-right:none;
        border-bottom:2px solid #e0e0e0;
        padding-top: 70px;
    }
    
    .preview-section {
        padding: 20px;
    }
}

@media (max-width: 768px) {
    .logo {
        font-size: 1.3em;
        margin-bottom: 20px;
    }
    
    .form-section, .preview-section {
        padding: 15px;
    }
    
    .form-section {
        padding-top: 70px;
    }
    
    .form-header h1 {
        font-size: 1.5em;
    }
    
    .section-header {
        margin: 20px -15px 15px -15px;
        font-size: 1.1em;
        padding: 12px;
    }
    
    .action-buttons {
        padding: 10px 0;
    }
    
    .action-buttons button {
        min-width: 100px;
        padding: 10px 15px;
        font-size: 0.9em;
    }
    
    .tab {
        padding: 10px 15px;
        font-size: 0.9em;
    }
    
    .modal-content {
        margin: 20px;
        padding: 20px;
        max-width: calc(100% - 40px);
    }
    
    .dynamic-item {
        padding-right: 70px;
    }
    
    .dynamic-item .remove-btn {
        padding: 6px 10px;
        font-size: 0.8em;
    }
}

@media (max-width: 480px) {
    .action-buttons {
        flex-direction: column;
    }
    
    .action-buttons button {
        width: 100%;
        min-width: unset;
    }
    
    .match-score {
        flex-direction: column;
    }
    
    .score-box {
        width: 100%;
    }
    
    .container {
        box-shadow: none;
    }
    
    header {
        padding: 25px 20px;
    }
    
    header h1 {
        font-size: 1.5em;
    }
    
    .content {
        padding: 20px;
    }
    
    h2 {
        font-size: 1.4em;
    }
}

@media print {
    .sidebar, .form-section, .action-buttons, .mobile-menu-toggle, .sidebar-overlay {display:none;}
    .main-content {margin-left:0;}
    .preview-section {padding:0;}
    .cv-preview {box-shadow:none;}
}
</style>
</head>
<body>
<!-- Mobile Menu Toggle -->
<button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
    <i class="fas fa-bars"></i>
</button>

<!-- Sidebar Overlay -->
<div class="sidebar-overlay" onclick="closeMobileMenu()"></div>

<div class="app-container">
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="logo">Free CV Builder</div>
        
        <div class="nav-item active" onclick="showTab('basic'); closeMobileMenu();">
            <i class="fas fa-user"></i>
            <span>Basic Info</span>
        </div>
        <div class="nav-item" onclick="showTab('experience'); closeMobileMenu();">
            <i class="fas fa-briefcase"></i>
            <span>Experience</span>
        </div>
        <div class="nav-item" onclick="showTab('education'); closeMobileMenu();">
            <i class="fas fa-graduation-cap"></i>
            <span>Education</span>
        </div>
        <div class="nav-item" onclick="showTab('skills'); closeMobileMenu();">
            <i class="fas fa-tools"></i>
            <span>Skills</span>
        </div>
        <div class="nav-item" onclick="showTab('certifications'); closeMobileMenu();">
            <i class="fas fa-certificate"></i>
            <span>Certifications</span>
        </div>
        <div class="nav-item" onclick="showTab('languages'); closeMobileMenu();">
            <i class="fas fa-language"></i>
            <span>Languages</span>
        </div>
        <div class="nav-item" onclick="showTab('publications'); closeMobileMenu();">
            <i class="fas fa-book"></i>
            <span>Publications</span>
        </div>
        <div class="nav-item" onclick="showTab('ats'); closeMobileMenu();">
            <i class="fas fa-chart-line"></i>
            <span>ATS Analysis</span>
        </div>
        
        <div class="score-card">
            <div class="score-value" id="sidebarScore">0</div>
            <div class="score-label">ATS Score</div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Form Section -->
        <div class="form-section">
            <div class="action-buttons">
                <button class="generate-btn" onclick="generateCV()"><i class="fas fa-sync"></i> Generate CV</button>
                <button class="download-btn" onclick="downloadDOCX()"><i class="fas fa-download"></i> Download</button>
                <button class="save-btn" onclick="saveCV()"><i class="fas fa-save"></i> Save</button>
                <button class="load-btn" onclick="openLoadModal()"><i class="fas fa-folder-open"></i> Load</button>
            </div>

            <div class="form-header">
                <h1>Create Your Professional CV</h1>
                <p>Fill in your details and watch your CV come to life in real-time</p>
            </div>

            <!-- Basic Info Tab -->
            <div id="basic" class="tab-content active">
                <div class="section-header">Personal Information</div>
                
                <div class="form-group">
                    <label for="fullName">Full Name *</label>
                    <input type="text" id="fullName" placeholder="John Doe" oninput="generateCV()">
                </div>
                
                <div class="form-group">
                    <label for="jobTitle">Professional Title *</label>
                    <input type="text" id="jobTitle" placeholder="Senior Software Engineer" oninput="generateCV()">
                    <small>This appears right below your name</small>
                </div>
                
                <div class="form-group">
                    <label for="location">Location</label>
                    <input type="text" id="location" placeholder="New York, NY" oninput="generateCV()">
                </div>
                
                <div class="section-header">Contact Information</div>
                
                <div class="form-group">
                    <label for="email">Email *</label>
                    <input type="email" id="email" placeholder="john@example.com" oninput="generateCV()">
                </div>
                
                <div class="form-group">
                    <label for="phone">Phone</label>
                    <input type="tel" id="phone" placeholder="+1 (555) 123-4567" oninput="generateCV()">
                </div>
                
                <div class="form-group">
                    <label for="linkedin">LinkedIn</label>
                    <input type="url" id="linkedin" placeholder="linkedin.com/in/johndoe" oninput="generateCV()">
                </div>
                
                <div class="form-group">
                    <label for="github">GitHub</label>
                    <input type="url" id="github" placeholder="github.com/johndoe" oninput="generateCV()">
                </div>
                
                <div class="form-group">
                    <label for="twitter">Twitter/X</label>
                    <input type="url" id="twitter" placeholder="twitter.com/johndoe" oninput="generateCV()">
                </div>
                
                <div class="form-group">
                    <label for="website">Personal Website</label>
                    <input type="url" id="website" placeholder="johndoe.com" oninput="generateCV()">
                </div>
                
                <div class="form-group">
                    <label for="otherLinkLabel">Other Link Label</label>
                    <input type="text" id="otherLinkLabel" placeholder="Portfolio" oninput="generateCV()">
                </div>
                
                <div class="form-group">
                    <label for="otherLink">Other Link URL</label>
                    <input type="url" id="otherLink" placeholder="portfolio.com" oninput="generateCV()">
                </div>
                
                <div class="section-header">Professional Summary</div>
                
                <div class="form-group">
                    <label for="summary">Summary *</label>
                    <textarea id="summary" placeholder="Write a compelling summary that highlights your key achievements and expertise..." oninput="generateCV()"></textarea>
                    <small>2-3 sentences highlighting your expertise and value proposition</small>
                </div>
                
                <div class="form-group">
                    <label for="orcid">ORCID (Optional)</label>
                    <input type="text" id="orcid" placeholder="0000-0000-0000-0000" oninput="generateCV()">
                    <small>For academic CVs</small>
                </div>
            </div>

            <!-- Experience Tab -->
            <div id="experience" class="tab-content">
                <div class="section-header">Work Experience</div>
                <div id="experienceList"></div>
                <button class="add-btn" onclick="addExperience()"><i class="fas fa-plus"></i> Add Experience</button>
            </div>

            <!-- Education Tab -->
            <div id="education" class="tab-content">
                <div class="section-header">Education</div>
                <div id="educationList"></div>
                <button class="add-btn" onclick="addEducation()"><i class="fas fa-plus"></i> Add Education</button>
            </div>

            <!-- Skills Tab -->
            <div id="skills" class="tab-content">
                <div class="section-header">Skills</div>
                <div class="form-group">
                    <label>Add Skills</label>
                    <div class="skill-input-container">
                        <input type="text" id="skillInput" placeholder="Enter skill name">
                        <button onclick="addSkill()"><i class="fas fa-plus"></i> Add</button>
                    </div>
                </div>
                <div id="skillsList"></div>
            </div>

            <!-- Certifications Tab -->
            <div id="certifications" class="tab-content">
                <div class="section-header">Certifications</div>
                <div id="certificationsList"></div>
                <button class="add-btn" onclick="addCertification()"><i class="fas fa-plus"></i> Add Certification</button>
            </div>

            <!-- Languages Tab -->
            <div id="languages" class="tab-content">
                <div class="section-header">Languages</div>
                <div id="languagesList"></div>
                <button class="add-btn" onclick="addLanguage()"><i class="fas fa-plus"></i> Add Language</button>
            </div>

            <!-- Publications Tab -->
            <div id="publications" class="tab-content">
                <div class="section-header">Publications</div>
                <div id="publicationsList"></div>
                <button class="add-btn" onclick="addCustomPublication()"><i class="fas fa-plus"></i> Add Publication</button>
            </div>

            <!-- ATS Analysis Tab -->
            <div id="ats" class="tab-content">
                <div class="section-header">ATS Optimization</div>
                
                <div class="ats-analyzer">
                    <h3><i class="fas fa-robot"></i> ATS Score Analyzer</h3>
                    <p>Paste a job description below to analyze how well your CV matches:</p>
                    
                    <div class="form-group">
                        <textarea id="jobDescription" placeholder="Paste job description here..." style="min-height:150px;"></textarea>
                    </div>
                    
                    <button class="add-btn" onclick="analyzeATS()"><i class="fas fa-search"></i> Analyze Match</button>
                    
                    <div id="atsResults" class="ats-results"></div>
                </div>
                
                <div class="feedback-panel">
                    <h4><i class="fas fa-lightbulb"></i> ATS Optimization Tips</h4>
                    <div class="feedback-item">
                        <i class="fas fa-check-circle"></i>
                        <span>Use keywords from the job description naturally in your experience</span>
                    </div>
                    <div class="feedback-item">
                        <i class="fas fa-check-circle"></i>
                        <span>Quantify achievements with numbers and percentages</span>
                    </div>
                    <div class="feedback-item">
                        <i class="fas fa-check-circle"></i>
                        <span>Use standard section headers (Experience, Education, Skills)</span>
                    </div>
                    <div class="feedback-item">
                        <i class="fas fa-check-circle"></i>
                        <span>Avoid images, tables, and complex formatting</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Preview Section -->
        <div class="preview-section">
            <div id="cvPreview1" class="cv-preview active"></div>
        </div>
    </div>
</div>

<!-- Load CV Modal -->
<div id="loadModal" class="modal">
    <div class="modal-content">
        <span class="close-modal" onclick="closeLoadModal()">&times;</span>
        <h2>Load Saved CV</h2>
        <div id="savedCVList"></div>
    </div>
</div>

<script>
// Mobile menu functions
function toggleMobileMenu() {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.querySelector('.sidebar-overlay');
    sidebar.classList.toggle('active');
    overlay.classList.toggle('active');
}

function closeMobileMenu() {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.querySelector('.sidebar-overlay');
    sidebar.classList.remove('active');
    overlay.classList.remove('active');
}

// Navigation
function showTab(tabName) {
    // Hide all tabs
    document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
    });
    
    // Remove active from nav items
    document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
    });
    
    // Show selected tab
    document.getElementById(tabName).classList.add('active');
    
    // Add active to nav item
    event.currentTarget.classList.add('active');
}

// Data structures
let experiences = [];
let education = [];
let skills = [];
let certifications = [];
let languages = [];
let customPublications = [];
let expId = 0;
let eduId = 0;
let certId = 0;
let langId = 0;
let pubId = 0;

// Experience functions
function addExperience() {
    const exp = {
        id: expId++,
        title: '',
        company: '',
        location: '',
        startDate: '',
        endDate: '',
        current: false,
        description: ''
    };
    experiences.push(exp);
    renderExperiences();
}

function removeExperience(id) {
    experiences = experiences.filter(exp => exp.id !== id);
    renderExperiences();
    generateCV();
}

function updateExperience(id, field, value) {
    const exp = experiences.find(e => e.id === id);
    if (exp) {
        if (field === 'current') {
            exp[field] = value;
            if (value) {
                exp.endDate = 'Present';
            }
        } else {
            exp[field] = value;
        }
    }
    generateCV();
}

function renderExperiences() {
    const list = document.getElementById('experienceList');
    list.innerHTML = experiences.map(exp => `
        <div class="dynamic-item">
            <button class="remove-btn" onclick="removeExperience(${exp.id})">Remove</button>
            <div class="form-group">
                <label>Job Title</label>
                <input type="text" value="${exp.title}" oninput="updateExperience(${exp.id}, 'title', this.value)" placeholder="Senior Software Engineer">
            </div>
            <div class="form-group">
                <label>Company</label>
                <input type="text" value="${exp.company}" oninput="updateExperience(${exp.id}, 'company', this.value)" placeholder="Tech Corp">
            </div>
            <div class="form-group">
                <label>Location</label>
                <input type="text" value="${exp.location}" oninput="updateExperience(${exp.id}, 'location', this.value)" placeholder="San Francisco, CA">
            </div>
            <div class="form-group">
                <label>Start Date</label>
                <input type="month" value="${exp.startDate}" oninput="updateExperience(${exp.id}, 'startDate', this.value)">
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" ${exp.current ? 'checked' : ''} onchange="updateExperience(${exp.id}, 'current', this.checked)">
                    Currently working here
                </label>
            </div>
            <div class="form-group" style="display:${exp.current ? 'none' : 'block'}">
                <label>End Date</label>
                <input type="month" value="${exp.endDate !== 'Present' ? exp.endDate : ''}" oninput="updateExperience(${exp.id}, 'endDate', this.value)" ${exp.current ? 'disabled' : ''}>
            </div>
            <div class="form-group">
                <label>Description</label>
                <textarea oninput="updateExperience(${exp.id}, 'description', this.value)" placeholder="• Led team of 5 engineers&#10;• Increased performance by 40%&#10;• Implemented new features">${exp.description}</textarea>
                <small>Use bullet points (•) for better readability</small>
            </div>
        </div>
    `).join('');
}

// Education functions
function addEducation() {
    const edu = {
        id: eduId++,
        degree: '',
        institution: '',
        location: '',
        startDate: '',
        endDate: '',
        current: false,
        description: ''
    };
    education.push(edu);
    renderEducation();
}

function removeEducation(id) {
    education = education.filter(edu => edu.id !== id);
    renderEducation();
    generateCV();
}

function updateEducation(id, field, value) {
    const edu = education.find(e => e.id === id);
    if (edu) {
        if (field === 'current') {
            edu[field] = value;
            if (value) {
                edu.endDate = 'Present';
            }
        } else {
            edu[field] = value;
        }
    }
    generateCV();
}

function renderEducation() {
    const list = document.getElementById('educationList');
    list.innerHTML = education.map(edu => `
        <div class="dynamic-item">
            <button class="remove-btn" onclick="removeEducation(${edu.id})">Remove</button>
            <div class="form-group">
                <label>Degree</label>
                <input type="text" value="${edu.degree}" oninput="updateEducation(${edu.id}, 'degree', this.value)" placeholder="Bachelor of Science in Computer Science">
            </div>
            <div class="form-group">
                <label>Institution</label>
                <input type="text" value="${edu.institution}" oninput="updateEducation(${edu.id}, 'institution', this.value)" placeholder="Stanford University">
            </div>
            <div class="form-group">
                <label>Location</label>
                <input type="text" value="${edu.location}" oninput="updateEducation(${edu.id}, 'location', this.value)" placeholder="Stanford, CA">
            </div>
            <div class="form-group">
                <label>Start Date</label>
                <input type="month" value="${edu.startDate}" oninput="updateEducation(${edu.id}, 'startDate', this.value)">
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" ${edu.current ? 'checked' : ''} onchange="updateEducation(${edu.id}, 'current', this.checked)">
                    Currently studying here
                </label>
            </div>
            <div class="form-group" style="display:${edu.current ? 'none' : 'block'}">
                <label>End Date</label>
                <input type="month" value="${edu.endDate !== 'Present' ? edu.endDate : ''}" oninput="updateEducation(${edu.id}, 'endDate', this.value)" ${edu.current ? 'disabled' : ''}>
            </div>
            <div class="form-group">
                <label>Description</label>
                <textarea oninput="updateEducation(${edu.id}, 'description', this.value)" placeholder="GPA: 3.8/4.0&#10;Relevant coursework: Data Structures, Algorithms">${edu.description}</textarea>
            </div>
        </div>
    `).join('');
}

// Skills functions
function addSkill() {
    const input = document.getElementById('skillInput');
    const skillName = input.value.trim();
    
    if (skillName && !skills.includes(skillName)) {
        skills.push(skillName);
        input.value = '';
        renderSkills();
        generateCV();
    }
}

function removeSkill(skillName) {
    skills = skills.filter(s => s !== skillName);
    renderSkills();
    generateCV();
}

function renderSkills() {
    const list = document.getElementById('skillsList');
    list.innerHTML = skills.map(skill => `
        <span class="keyword-item" style="margin:5px;">
            ${skill}
            <i class="fas fa-times" style="margin-left:5px;cursor:pointer;" onclick="removeSkill('${skill}')"></i>
        </span>
    `).join('');
}

// Certifications functions
function addCertification() {
    const cert = {
        id: certId++,
        name: '',
        issuer: '',
        date: '',
        credentialId: ''
    };
    certifications.push(cert);
    renderCertifications();
}

function removeCertification(id) {
    certifications = certifications.filter(cert => cert.id !== id);
    renderCertifications();
    generateCV();
}

function updateCertification(id, field, value) {
    const cert = certifications.find(c => c.id === id);
    if (cert) cert[field] = value;
    generateCV();
}

function renderCertifications() {
    const list = document.getElementById('certificationsList');
    list.innerHTML = certifications.map(cert => `
        <div class="dynamic-item">
            <button class="remove-btn" onclick="removeCertification(${cert.id})">Remove</button>
            <div class="form-group">
                <label>Certification Name</label>
                <input type="text" value="${cert.name}" oninput="updateCertification(${cert.id}, 'name', this.value)" placeholder="AWS Certified Solutions Architect">
            </div>
            <div class="form-group">
                <label>Issuing Organization</label>
                <input type="text" value="${cert.issuer}" oninput="updateCertification(${cert.id}, 'issuer', this.value)" placeholder="Amazon Web Services">
            </div>
            <div class="form-group">
                <label>Date Obtained</label>
                <input type="month" value="${cert.date}" oninput="updateCertification(${cert.id}, 'date', this.value)">
            </div>
            <div class="form-group">
                <label>Credential ID (Optional)</label>
                <input type="text" value="${cert.credentialId}" oninput="updateCertification(${cert.id}, 'credentialId', this.value)" placeholder="ABC123XYZ">
            </div>
        </div>
    `).join('');
}

// Languages functions
function addLanguage() {
    const lang = {
        id: langId++,
        name: '',
        proficiency: ''
    };
    languages.push(lang);
    renderLanguages();
}

function removeLanguage(id) {
    languages = languages.filter(lang => lang.id !== id);
    renderLanguages();
    generateCV();
}

function updateLanguage(id, field, value) {
    const lang = languages.find(l => l.id === id);
    if (lang) lang[field] = value;
    generateCV();
}

function renderLanguages() {
    const list = document.getElementById('languagesList');
    list.innerHTML = languages.map(lang => `
        <div class="dynamic-item">
            <button class="remove-btn" onclick="removeLanguage(${lang.id})">Remove</button>
            <div class="form-group">
                <label>Language</label>
                <input type="text" value="${lang.name}" oninput="updateLanguage(${lang.id}, 'name', this.value)" placeholder="Spanish">
            </div>
            <div class="form-group">
                <label>Proficiency</label>
                <select oninput="updateLanguage(${lang.id}, 'proficiency', this.value)">
                    <option value="">Select level</option>
                    <option value="Native" ${lang.proficiency === 'Native' ? 'selected' : ''}>Native</option>
                    <option value="Fluent" ${lang.proficiency === 'Fluent' ? 'selected' : ''}>Fluent</option>
                    <option value="Professional" ${lang.proficiency === 'Professional' ? 'selected' : ''}>Professional</option>
                    <option value="Intermediate" ${lang.proficiency === 'Intermediate' ? 'selected' : ''}>Intermediate</option>
                    <option value="Basic" ${lang.proficiency === 'Basic' ? 'selected' : ''}>Basic</option>
                </select>
            </div>
        </div>
    `).join('');
}

// Publications functions
function addCustomPublication() {
    const pub = {
        id: pubId++,
        title: '',
        authors: '',
        journal: '',
        year: '',
        doi: ''
    };
    customPublications.push(pub);
    renderCustomPublications();
}

function removeCustomPublication(id) {
    customPublications = customPublications.filter(pub => pub.id !== id);
    renderCustomPublications();
    generateCV();
}

function updateCustomPublication(id, field, value) {
    const pub = customPublications.find(p => p.id === id);
    if (pub) pub[field] = value;
    generateCV();
}

function renderCustomPublications() {
    const list = document.getElementById('publicationsList');
    list.innerHTML = customPublications.map(pub => `
        <div class="dynamic-item">
            <button class="remove-btn" onclick="removeCustomPublication(${pub.id})">Remove</button>
            <div class="form-group">
                <label>Publication Title</label>
                <input type="text" value="${pub.title}" oninput="updateCustomPublication(${pub.id}, 'title', this.value)" placeholder="Deep Learning for Computer Vision">
            </div>
            <div class="form-group">
                <label>Authors</label>
                <input type="text" value="${pub.authors}" oninput="updateCustomPublication(${pub.id}, 'authors', this.value)" placeholder="Smith, J., Doe, J., et al.">
            </div>
            <div class="form-group">
                <label>Journal/Conference</label>
                <input type="text" value="${pub.journal}" oninput="updateCustomPublication(${pub.id}, 'journal', this.value)" placeholder="Nature Machine Intelligence">
            </div>
            <div class="form-group">
                <label>Year</label>
                <input type="number" value="${pub.year}" oninput="updateCustomPublication(${pub.id}, 'year', this.value)" placeholder="2023" min="1900" max="2099">
            </div>
            <div class="form-group">
                <label>DOI (Optional)</label>
                <input type="text" value="${pub.doi}" oninput="updateCustomPublication(${pub.id}, 'doi', this.value)" placeholder="10.1038/s42256-023-00000-0">
            </div>
        </div>
    `).join('');
}

// CV Generation
function generateCV() {
    const fullName = document.getElementById('fullName').value;
    const jobTitle = document.getElementById('jobTitle').value;
    const email = document.getElementById('email').value;
    const phone = document.getElementById('phone').value;
    const linkedin = document.getElementById('linkedin').value;
    const github = document.getElementById('github').value;
    const twitter = document.getElementById('twitter').value;
    const website = document.getElementById('website').value;
    const otherLink = document.getElementById('otherLink').value;
    const otherLinkLabel = document.getElementById('otherLinkLabel').value;
    const location = document.getElementById('location').value;
    const summary = document.getElementById('summary').value;
    const orcid = document.getElementById('orcid').value;

    let contactLinks = [];
    if (email) contactLinks.push(`<a href="mailto:${email}"><i class="fas fa-envelope"></i> ${email}</a>`);
    if (phone) contactLinks.push(`<a href="tel:${phone}"><i class="fas fa-phone"></i> ${phone}</a>`);
    if (linkedin) contactLinks.push(`<a href="${linkedin.startsWith('http') ? linkedin : 'https://' + linkedin}" target="_blank"><i class="fab fa-linkedin"></i> LinkedIn</a>`);
    if (github) contactLinks.push(`<a href="${github.startsWith('http') ? github : 'https://' + github}" target="_blank"><i class="fab fa-github"></i> GitHub</a>`);
    if (twitter) contactLinks.push(`<a href="${twitter.startsWith('http') ? twitter : 'https://' + twitter}" target="_blank"><i class="fab fa-twitter"></i> Twitter</a>`);
    if (website) contactLinks.push(`<a href="${website.startsWith('http') ? website : 'https://' + website}" target="_blank"><i class="fas fa-globe"></i> Website</a>`);
    if (otherLink && otherLinkLabel) contactLinks.push(`<a href="${otherLink.startsWith('http') ? otherLink : 'https://' + otherLink}" target="_blank"><i class="fas fa-link"></i> ${otherLinkLabel}</a>`);

    let html = `
        <div class="container">
            <header>
                <h1>${fullName || 'Your Name'}</h1>
                <p>${jobTitle || 'Your Professional Title'}</p>
                ${location ? `<p><i class="fas fa-map-marker-alt"></i> ${location}</p>` : ''}
                ${orcid ? `<p><i class="fas fa-id-card"></i> ORCID: ${orcid}</p>` : ''}
                <div class="contact-info">
                    ${contactLinks.join(' ')}
                </div>
            </header>
            
            <div class="content">
    `;

    if (summary) {
        html += `
            <section>
                <h2>Professional Summary</h2>
                <div class="summary">${summary.replace(/\n/g, '<br>')}</div>
            </section>
        `;
    }

    if (experiences.length > 0) {
        html += `<section><h2>Professional Experience</h2>`;
        experiences.forEach(exp => {
            if (exp.title || exp.company) {
                const startDate = exp.startDate ? new Date(exp.startDate + '-01').toLocaleDateString('en-US', { month: 'short', year: 'numeric' }) : '';
                const endDate = exp.current ? 'Present' : (exp.endDate ? new Date(exp.endDate + '-01').toLocaleDateString('en-US', { month: 'short', year: 'numeric' }) : '');
                
                html += `
                    <div class="experience-item">
                        <div class="job-title">
                            <h3>${exp.title || 'Job Title'}</h3>
                            ${startDate ? `<span class="date">${startDate} - ${endDate}</span>` : ''}
                        </div>
                        <div class="company">${exp.company || 'Company Name'}${exp.location ? ' | ' + exp.location : ''}</div>
                        ${exp.description ? `<div>${exp.description.replace(/\n/g, '<br>')}</div>` : ''}
                    </div>
                `;
            }
        });
        html += `</section>`;
    }

    if (education.length > 0) {
        html += `<section><h2>Education</h2>`;
        education.forEach(edu => {
            if (edu.degree || edu.institution) {
                const startDate = edu.startDate ? new Date(edu.startDate + '-01').toLocaleDateString('en-US', { month: 'short', year: 'numeric' }) : '';
                const endDate = edu.current ? 'Present' : (edu.endDate ? new Date(edu.endDate + '-01').toLocaleDateString('en-US', { month: 'short', year: 'numeric' }) : '');
                
                html += `
                    <div class="education-item">
                        <div class="job-title">
                            <h3>${edu.degree || 'Degree'}</h3>
                            ${startDate ? `<span class="date">${startDate} - ${endDate}</span>` : ''}
                        </div>
                        <div class="company">${edu.institution || 'Institution'}${edu.location ? ' | ' + edu.location : ''}</div>
                        ${edu.description ? `<div>${edu.description.replace(/\n/g, '<br>')}</div>` : ''}
                    </div>
                `;
            }
        });
        html += `</section>`;
    }

    if (skills.length > 0) {
        html += `
            <section>
                <h2>Skills</h2>
                <div class="skills">
                    ${skills.map(skill => `<span class="skill-tag">${skill}</span>`).join('')}
                </div>
            </section>
        `;
    }

    if (certifications.length > 0) {
        html += `<section><h2>Certifications</h2>`;
        certifications.forEach(cert => {
            if (cert.name) {
                const date = cert.date ? new Date(cert.date + '-01').toLocaleDateString('en-US', { month: 'short', year: 'numeric' }) : '';
                html += `
                    <div class="publication">
                        <strong>${cert.name}</strong><br>
                        ${cert.issuer ? cert.issuer : ''}${date ? ' | ' + date : ''}
                        ${cert.credentialId ? `<br>Credential ID: ${cert.credentialId}` : ''}
                    </div>
                `;
            }
        });
        html += `</section>`;
    }

    if (languages.length > 0) {
        html += `
            <section>
                <h2>Languages</h2>
                <div class="languages">
                    ${languages.map(lang => lang.name ? `<span><strong>${lang.name}</strong>${lang.proficiency ? ': ' + lang.proficiency : ''}</span>` : '').join('')}
                </div>
            </section>
        `;
    }

    if (customPublications.length > 0) {
        html += `<section><h2>Publications</h2>`;
        customPublications.forEach(pub => {
            if (pub.title) {
                html += `
                    <div class="publication">
                        ${pub.authors ? pub.authors + '. ' : ''}<strong>${pub.title}</strong>. ${pub.journal ? pub.journal + '. ' : ''}${pub.year ? pub.year + '.' : ''}
                        ${pub.doi ? `<br><a href="https://doi.org/${pub.doi}" target="_blank">DOI: ${pub.doi}</a>` : ''}
                    </div>
                `;
            }
        });
        html += `</section>`;
    }

    html += `
            </div>
        </div>
    `;

    document.getElementById('cvPreview1').innerHTML = html;
}

// ATS Analysis
function analyzeATS() {
    const jobDesc = document.getElementById('jobDescription').value.toLowerCase();
    const cvText = document.getElementById('cvPreview1').innerText.toLowerCase();
    
    if (!jobDesc) {
        alert('Please paste a job description to analyze');
        return;
    }

    const keywords = extractKeywords(jobDesc);
    const matchedKeywords = keywords.filter(keyword => cvText.includes(keyword.toLowerCase()));
    const missingKeywords = keywords.filter(keyword => !cvText.includes(keyword.toLowerCase()));
    
    const score = keywords.length > 0 ? Math.round((matchedKeywords.length / keywords.length) * 100) : 0;
    
    document.getElementById('sidebarScore').textContent = score;

    let resultsHTML = `
        <div class="match-score">
            <div class="score-box">
                <div class="value">${score}%</div>
                <div class="label">Match Score</div>
            </div>
            <div class="score-box">
                <div class="value">${matchedKeywords.length}</div>
                <div class="label">Matched Keywords</div>
            </div>
            <div class="score-box">
                <div class="value">${missingKeywords.length}</div>
                <div class="label">Missing Keywords</div>
            </div>
        </div>
    `;

    if (matchedKeywords.length > 0) {
        resultsHTML += `
            <div style="margin-top:20px;">
                <h4 style="color:#10b981;"><i class="fas fa-check-circle"></i> Matched Keywords</h4>
                <div class="keyword-list">
                    ${matchedKeywords.map(kw => `<span class="keyword-item matched">${kw}</span>`).join('')}
                </div>
            </div>
        `;
    }

    if (missingKeywords.length > 0) {
        resultsHTML += `
            <div style="margin-top:20px;">
                <h4 style="color:#dc2626;"><i class="fas fa-exclamation-circle"></i> Missing Keywords</h4>
                <div class="keyword-list">
                    ${missingKeywords.map(kw => `<span class="keyword-item missing">${kw}</span>`).join('')}
                </div>
                <small style="display:block;margin-top:10px;color:#666;">Consider adding these keywords naturally to your CV if they match your experience</small>
            </div>
        `;
    }

    document.getElementById('atsResults').innerHTML = resultsHTML;
}

function extractKeywords(text) {
    const commonWords = ['the', 'and', 'for', 'with', 'this', 'that', 'from', 'have', 'has', 'will', 'are', 'was', 'were', 'been', 'being', 'our', 'your', 'their', 'about', 'into', 'through', 'during', 'including', 'such', 'other', 'than', 'more', 'most', 'must', 'should', 'could', 'would'];
    
    const words = text.match(/\b[a-z]{3,}\b/g) || [];
    const wordFreq = {};
    
    words.forEach(word => {
        if (!commonWords.includes(word)) {
            wordFreq[word] = (wordFreq[word] || 0) + 1;
        }
    });
    
    const sorted = Object.entries(wordFreq)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 30)
        .map(entry => entry[0]);
    
    return sorted;
}

// Download as DOCX
async function downloadDOCX() {
    const fullName = document.getElementById('fullName').value || 'CV';
    const filename = `${fullName.replace(/\s+/g, '_')}_CV.doc`;
    
    const cvContent = document.getElementById('cvPreview1').innerHTML;
    
    const wordHTML = `<!DOCTYPE html>
<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
<head>
<meta charset='utf-8'>
<title>CV</title>
<style>
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    line-height: 1.6;
    color: #333;
}
header {
    background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
    color: white;
    padding: 35px 40px;
    text-align: center;
}
header h1 {
    font-size: 2em;
    margin-bottom: 8px;
}
.contact-info a {
    color: white;
    margin: 0 10px;
}
.content {
    padding: 30px;
}
h2 {
    color: #0f172a;
    font-size: 1.8em;
    margin-bottom: 15px;
    padding-bottom: 8px;
    border-bottom: 3px solid #0f172a;
}
h3 {
    color: #333;
    font-size: 1.2em;
    margin-bottom: 5px;
}
.job-title {
    display: flex;
    justify-content: space-between;
    margin-bottom: 5px;
}
.company {
    color: #555;
    margin-bottom: 10px;
}
.skills {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}
.skill-tag {
    background-color: #0f172a;
    color: white;
    padding: 6px 12px;
    border-radius: 15px;
}
.summary {
    background-color: #f8f9fa;
    padding: 15px;
    border-left: 4px solid #0f172a;
}
.languages span {
    display: inline-block;
    margin-right: 20px;
    margin-bottom: 8px;
}
.publication {
    margin-bottom: 10px;
    padding: 12px;
    background-color: #f8f9fa;
}
.publication a {
    color: #0f172a;
    text-decoration: none;
}
</style>
</head>
<body>
${cvContent}
</body>
</html>`;

    const blob = new Blob(['\ufeff', wordHTML], { 
        type: 'application/msword;charset=utf-8' 
    });
    
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
}

// Save/Load CV
function saveCV() {
    const cvData = {
        fullName: document.getElementById('fullName').value,
        jobTitle: document.getElementById('jobTitle').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        linkedin: document.getElementById('linkedin').value,
        github: document.getElementById('github').value,
        twitter: document.getElementById('twitter').value,
        website: document.getElementById('website').value,
        otherLink: document.getElementById('otherLink').value,
        otherLinkLabel: document.getElementById('otherLinkLabel').value,
        location: document.getElementById('location').value,
        summary: document.getElementById('summary').value,
        orcid: document.getElementById('orcid').value,
        skills: skills,
        experiences: experiences,
        education: education,
        certifications: certifications,
        languages: languages,
        customPublications: customPublications,
        savedDate: new Date().toISOString()
    };
    
    const cvName = prompt('Enter a name for this CV version:', cvData.fullName + ' - ' + new Date().toLocaleDateString());
    if (!cvName) return;
    
    const savedCVs = JSON.parse(localStorage.getItem('savedCVs') || '{}');
    savedCVs[cvName] = cvData;
    localStorage.setItem('savedCVs', JSON.stringify(savedCVs));
    
    alert('CV saved successfully!');
}

function openLoadModal() {
    const savedCVs = JSON.parse(localStorage.getItem('savedCVs') || '{}');
    const list = document.getElementById('savedCVList');
    
    if (Object.keys(savedCVs).length === 0) {
        list.innerHTML = '<p style="text-align:center;color:#666;padding:20px;">No saved CVs found</p>';
    } else {
        list.innerHTML = Object.keys(savedCVs).map(name => {
            const cv = savedCVs[name];
            const date = new Date(cv.savedDate).toLocaleDateString();
            return `
                <div class="saved-cv-item" onclick="loadCV('${name}')">
                    <div>
                        <strong>${name}</strong>
                        <div style="font-size:0.85em;color:#666;">Saved: ${date}</div>
                    </div>
                    <button class="remove-btn" onclick="event.stopPropagation(); deleteCV('${name}')">Delete</button>
                </div>
            `;
        }).join('');
    }
    
    document.getElementById('loadModal').style.display = 'block';
}

function closeLoadModal() {
    document.getElementById('loadModal').style.display = 'none';
}

function loadCV(name) {
    const savedCVs = JSON.parse(localStorage.getItem('savedCVs') || '{}');
    const cvData = savedCVs[name];
    
    if (!cvData) {
        alert('CV not found');
        return;
    }
    
    document.getElementById('fullName').value = cvData.fullName || '';
    document.getElementById('jobTitle').value = cvData.jobTitle || '';
    document.getElementById('email').value = cvData.email || '';
    document.getElementById('phone').value = cvData.phone || '';
    document.getElementById('linkedin').value = cvData.linkedin || '';
    document.getElementById('github').value = cvData.github || '';
    document.getElementById('twitter').value = cvData.twitter || '';
    document.getElementById('website').value = cvData.website || '';
    document.getElementById('otherLink').value = cvData.otherLink || '';
    document.getElementById('otherLinkLabel').value = cvData.otherLinkLabel || '';
    document.getElementById('location').value = cvData.location || '';
    document.getElementById('summary').value = cvData.summary || '';
    document.getElementById('orcid').value = cvData.orcid || '';
    
    skills = cvData.skills || [];
    experiences = cvData.experiences || [];
    education = cvData.education || [];
    certifications = cvData.certifications || [];
    languages = cvData.languages || [];
    customPublications = cvData.customPublications || [];
    
    expId = experiences.length > 0 ? Math.max(...experiences.map(e => e.id)) + 1 : 0;
    eduId = education.length > 0 ? Math.max(...education.map(e => e.id)) + 1 : 0;
    certId = certifications.length > 0 ? Math.max(...certifications.map(c => c.id)) + 1 : 0;
    langId = languages.length > 0 ? Math.max(...languages.map(l => l.id)) + 1 : 0;
    pubId = customPublications.length > 0 ? Math.max(...customPublications.map(p => p.id)) + 1 : 0;
    
    renderSkills();
    renderExperiences();
    renderEducation();
    renderCertifications();
    renderLanguages();
    renderCustomPublications();
    
    closeLoadModal();
    generateCV();
    alert('CV loaded successfully!');
}

function deleteCV(name) {
    if (!confirm('Are you sure you want to delete this CV?')) return;
    
    const savedCVs = JSON.parse(localStorage.getItem('savedCVs') || '{}');
    delete savedCVs[name];
    localStorage.setItem('savedCVs', JSON.stringify(savedCVs));
    
    openLoadModal();
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
    addExperience();
    addEducation();
    generateCV();
});

// Allow Enter key to add skills
document.getElementById('skillInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        e.preventDefault();
        addSkill();
    }
});
</script>
</body>
</html>
